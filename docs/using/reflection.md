---
url: 'https://zenithgram.github.io/using/reflection.md'
description: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Dependency Injection –∏ —Ä–µ—Ñ–ª–µ–∫—Å–∏–∏ –¥–ª—è —á–∏—Å—Ç–æ–≥–æ –∫–æ–¥–∞.
---

–í–æ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø–æ **–í–Ω–µ–¥—Ä–µ–Ω–∏—é –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (Dependency Injection)** –∏ **–†–µ—Ñ–ª–µ–∫—Å–∏–∏**.

–Ø –ø–µ—Ä–µ–ø–∏—Å–∞–ª –µ—ë —Ç–∞–∫, —á—Ç–æ–±—ã —á–µ—Ç–∫–æ –≤—ã–¥–µ–ª–∏—Ç—å:
1.  **–†–∞–∑–Ω–∏—Ü—É —Ä–µ–∂–∏–º–æ–≤:** –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π (—Ä—É—á–Ω–æ–π) vs –†–µ—Ñ–ª–µ–∫—Å–∏—è (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π).
2.  **–í–∞–∂–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ:** –†–µ—Ñ–ª–µ–∫—Å–∏—è –≤—ã–∫–ª—é—á–µ–Ω–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.
3.  **–°—Ç—Ä–∞—Ç–µ–≥–∏—é –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è:** –ü–æ—á–µ–º—É –≤ Dev –Ω–µ–ª—å–∑—è, –∞ –≤ Prod –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ.
4.  **–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è LLM:** –ß–µ—Ç–∫–∏–µ —É–∫–∞–∑–∞–Ω–∏—è —Ç–∏–ø–æ–≤ –∏ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤.

---

# –í–Ω–µ–¥—Ä–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏ –†–µ—Ñ–ª–µ–∫—Å–∏—è (Dependency Injection)

ZenithGram –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –Ω–∞–ø–∏—Å–∞–Ω–∏—é –∫–æ–¥–∞ —á–µ—Ä–µ–∑ **Dependency Injection (DI)**. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–∏—Å–∞—Ç—å —á–∏—Å—Ç—ã–µ, —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏, –∏–∑–±–∞–≤–ª—è—è –≤–∞—Å –æ—Ç —Ä—É—Ç–∏–Ω–Ω–æ–≥–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ –æ–±—ä–µ–∫—Ç–∞ `$tg`.

::: warning –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤—ã–∫–ª—é—á–µ–Ω–æ
–ò–∑ –∫–æ—Ä–æ–±–∫–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ **—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º —Ä–µ–∂–∏–º–µ** (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å). –í —ç—Ç–æ–º —Ä–µ–∂–∏–º–µ –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ä–æ—É—Ç–µ—Ä–∞ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –æ–±—ä–µ–∫—Ç `ZG` –∏ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç—ã.

–ß—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å DI –∏ Type Hinting, –≤—ã –¥–æ–ª–∂–Ω—ã **—è–≤–Ω–æ –≤–∫–ª—é—á–∏—Ç—å** —Ä–µ—Ñ–ª–µ–∫—Å–∏—é (—Å–º. –Ω–∏–∂–µ).
:::

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤

### –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–æ–¥—Ö–æ–¥ (–ë–µ–∑ —Ä–µ—Ñ–ª–µ–∫—Å–∏–∏)
–í–∞–º –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –≤—Ä—É—á–Ω—É—é –¥–æ—Å—Ç–∞–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ. –ê—Ä–≥—É–º–µ–Ω—Ç—ã –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –∑–∞—Ä–∞–Ω–µ–µ.

```php
$bot->onCommand('start', '/start')->func(function(ZG $tg) {
    // –ü—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –ø–∏—Å–∞—Ç—å –ª–∏—à–Ω–∏–π –∫–æ–¥
    $user = $tg->getUser(); 
    $chat = $tg->getChat();
    
    $tg->reply("–ü—Ä–∏–≤–µ—Ç, {$user->firstName}!");
});
```

### –ü–æ–¥—Ö–æ–¥ —Å –†–µ—Ñ–ª–µ–∫—Å–∏–µ–π (Dependency Injection)
–í—ã –ø—Ä–æ—Å—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç–µ –≤ –∞—Ä–≥—É–º–µ–Ω—Ç–∞—Ö —Ñ—É–Ω–∫—Ü–∏–∏ **–¢–∏–ø** —Ç–æ–≥–æ, —á—Ç–æ –≤–∞–º –Ω—É–∂–Ω–æ. –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Å–∞–º–∞ –Ω–∞–π–¥–µ—Ç, —Å–æ–∑–¥–∞—Å—Ç –∏ –ø–µ—Ä–µ–¥–∞—Å—Ç —ç—Ç–æ—Ç –æ–±—ä–µ–∫—Ç.

```php
use ZenithGram\ZenithGram\Dto\UserDto;
use ZenithGram\ZenithGram\Dto\ChatDto;

// –í–∫–ª—é—á–∞–µ–º —Ä–µ—Ñ–ª–µ–∫—Å–∏—é
$bot->reflection(); 

$bot->onCommand('start', '/start')
    ->func(function(UserDto $user, ChatDto $chat, ZG $tg) {
        // $user –∏ $chat —É–∂–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –¥–∞–Ω–Ω—ã–º–∏!
        // –ü–æ—Ä—è–¥–æ–∫ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –Ω–µ –≤–∞–∂–µ–Ω.
        $tg->reply("–ü—Ä–∏–≤–µ—Ç, {$user->firstName}!");
    });
```

## –ö–∞–∫ –≤–∫–ª—é—á–∏—Ç—å —Ä–µ—Ñ–ª–µ–∫—Å–∏—é?

–ï—Å—Ç—å —Ç—Ä–∏ —Å–ø–æ—Å–æ–±–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:

1.  **–ë–∞–∑–æ–≤–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è:** `$bot->reflection()` ‚Äî –≤–∫–ª—é—á–∞–µ—Ç –∞–≤—Ç–æ-–ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫—É –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö DTO –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–∞—Ä—à—Ä—É—Ç–∞.
2.  **–° –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º:** `$bot->setContainer($container)` ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á–∞–µ—Ç —Ä–µ—Ñ–ª–µ–∫—Å–∏—é –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–Ω–µ–¥—Ä—è—Ç—å –≤–∞—à–∏ —Å–µ—Ä–≤–∏—Å—ã (DB, Logger).
3.  **–° –∫–µ—à–µ–º:** `$bot->setCache($cache)` ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á–∞–µ—Ç —Ä–µ—Ñ–ª–µ–∫—Å–∏—é (–¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞).

## –ß—Ç–æ –º–æ–∂–Ω–æ –≤–Ω–µ–¥—Ä—è—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏?
–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ —É–º–µ–µ—Ç —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å –∏ –≤–Ω–µ–¥—Ä—è—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∫–ª–∞—Å—Å—ã:

| –ö–ª–∞—Å—Å / –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å                      | –û–ø–∏—Å–∞–Ω–∏–µ                                        |
|:---------------------------------------|:------------------------------------------------|
| `ZenithGram\ZenithGram\ZG`             | –û—Å–Ω–æ–≤–Ω–æ–π –æ–±—ä–µ–∫—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫–∏.                     |
| `ZenithGram\ZenithGram\Dto\UserDto`    | –û–±—ä–µ–∫—Ç —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∏–∑ –ø–æ–ª—è `from`). |
| `ZenithGram\ZenithGram\Dto\ChatDto`    | –û–±—ä–µ–∫—Ç —Å –¥–∞–Ω–Ω—ã–º–∏ —á–∞—Ç–∞.                          |
| `ZenithGram\ZenithGram\Dto\MessageDto` | –ü–æ–ª–Ω—ã–π –æ–±—ä–µ–∫—Ç —Å–æ–æ–±—â–µ–Ω–∏—è.                        |
| `ZenithGram\ZenithGram\UpdateContext`  | –°—ã—Ä–æ–π –∫–æ–Ω—Ç–µ–∫—Å—Ç —Ç–µ–∫—É—â–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è.             |

## –ê—Ä–≥—É–º–µ–Ω—Ç—ã –º–∞—Ä—à—Ä—É—Ç–æ–≤ (Named Parameters)
–†–µ—Ñ–ª–µ–∫—Å–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –≤ –∫–æ–º–∞–Ω–¥–∞—Ö –∏ –∫–Ω–æ–ø–∫–∞—Ö.
**–ò–º—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π** –≤ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ–ª–∂–Ω–æ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å **–∏–º–µ–Ω–µ–º –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–∞** –≤ –º–∞—Ä—à—Ä—É—Ç–µ.

### –ü—Ä–∏–º–µ—Ä —Å –∫–æ–º–∞–Ω–¥–æ–π
–ú–∞—Ä—à—Ä—É—Ç: `/gift {username} {amount}`
```php
$bot->onCommand('gift', '/gift {username} {amount}')
    ->func(function (ZG $tg, string $username, int $amount) {
        // –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç —Ç–µ–∫—Å—Ç –∫–æ–º–∞–Ω–¥—ã
        // –∏ –ø–µ—Ä–µ–¥–∞—Å—Ç –∑–Ω–∞—á–µ–Ω–∏—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ $username –∏ $amount
        $tg->reply("–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ $amount –º–æ–Ω–µ—Ç –¥–ª—è $username");
    });
```

### –ü—Ä–∏–º–µ—Ä —Å –∫–Ω–æ–ø–∫–æ–π (Callback)
–î–∞–Ω–Ω—ã–µ –∫–Ω–æ–ø–∫–∏: `product_{id}_delete`
```php
$bot->onCallback('del_prod', 'product_{id}_delete')
    ->func(function (ZG $tg, int $id, UserDto $user) {
        // –ú—ã –ø–æ–ª—É—á–∏–ª–∏ ID —Ç–æ–≤–∞—Ä–∞ –∏–∑ –∫–Ω–æ–ø–∫–∏
        // –ò –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ DTO
        $tg->reply("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {$user->firstName} —É–¥–∞–ª–∏–ª —Ç–æ–≤–∞—Ä #$id");
    });
```

## –†–∞–±–æ—Ç–∞ —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏ (PSR-11)
–ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ **PHP-DI**, **Symfony Container** –∏–ª–∏ –ª—é–±–æ–π –¥—Ä—É–≥–æ–π PSR-11 —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –≤—ã –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–¥–∞—Ç—å –µ–≥–æ –≤ –±–æ—Ç–∞. –≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –≤–∞–º –∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å —Å–≤–æ–∏ —Å–µ—Ä–≤–∏—Å—ã (–±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, API –∫–ª–∏–µ–Ω—Ç–æ–≤) –ø—Ä—è–º–æ –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞—Ö –±–æ—Ç–∞.
```php
use DI\ContainerBuilder;

// 1. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –≤–∞—à –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (–ü—Ä–∏–º–µ—Ä —Å PHP-DI)
$builder = new ContainerBuilder();
$builder->addDefinitions([
    DatabaseService::class => fn() => new DatabaseService(...),
    LoggerService::class => fn() => new LoggerService(...)
]);
$container = $builder->build();

// 2. –ü–µ—Ä–µ–¥–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤ –±–æ—Ç–∞
// –í–ù–ò–ú–ê–ù–ò–ï: –≠—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á–∞–µ—Ç —Ä–µ–∂–∏–º reflection()
$bot->setContainer($container);

// 3. –ò—Å–ø–æ–ª—å–∑—É–µ–º –≤ –∫–æ–¥–µ
$bot->onCommand('balance', '/balance')
    ->func(function (ZG $tg, UserDto $user, DatabaseService $db) {
        // DatabaseService –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∑—è—Ç –∏–∑ –≤–∞—à–µ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
        $balance = $db->getUserBalance($user->id);
        $tg->reply("–í–∞—à –±–∞–ª–∞–Ω—Å: $balance");
    });
```

## –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
–†–µ—Ñ–ª–µ–∫—Å–∏—è (–∞–Ω–∞–ª–∏–∑ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ —Ñ—É–Ω–∫—Ü–∏–π "–Ω–∞ –ª–µ—Ç—É") ‚Äî —ç—Ç–æ **—Ç—è–∂–µ–ª–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è**. –û–Ω–∞ –º–æ–∂–µ—Ç –∑–∞–º–µ–¥–ª–∏—Ç—å –±–æ—Ç–∞ –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ. –ß—Ç–æ–±—ã —ç—Ç–æ–≥–æ –∏–∑–±–µ–∂–∞—Ç—å, ZenithGram –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π.

### ‚ö†Ô∏è –°—Ç—Ä–∞—Ç–µ–≥–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–µ—à–∞

#### üõ† –í –†–∞–∑—Ä–∞–±–æ—Ç–∫–µ (Local / Dev) ‚Äî –ö–ï–® –ù–ï –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨
–ü—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –≤—ã —á–∞—Å—Ç–æ –º–µ–Ω—è–µ—Ç–µ –∫–æ–¥: –¥–æ–±–∞–≤–ª—è–µ—Ç–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã, –º–µ–Ω—è–µ—Ç–µ –∏—Ö –º–µ—Å—Ç–∞–º–∏.
–ï—Å–ª–∏ –∫–µ—à –≤–∫–ª—é—á–µ–Ω, –±–æ—Ç "–∑–∞–ø–æ–º–Ω–∏—Ç" —Å—Ç–∞—Ä—É—é —Å–∏–≥–Ω–∞—Ç—É—Ä—É —Ñ—É–Ω–∫—Ü–∏–∏. –í—ã –∏–∑–º–µ–Ω–∏—Ç–µ –∫–æ–¥, –Ω–æ –±–æ—Ç –ø—Ä–æ–¥–æ–ª–∂–∏—Ç –ø—ã—Ç–∞—Ç—å—Å—è –ø–µ—Ä–µ–¥–∞—Ç—å —Å—Ç–∞—Ä—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã, —á—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –æ—à–∏–±–∫–µ.

> **–ü—Ä–∞–≤–∏–ª–æ:** –ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ –ø—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `$bot->reflection()` –∏–ª–∏ `$bot->setContainer(...)` –±–µ–∑ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∫–µ—à–∞.

#### üöÄ –í –ü—Ä–æ–¥–∞–∫—à–µ–Ω–µ (Prod) ‚Äî –ö–ï–® –û–ë–Ø–ó–ê–¢–ï–õ–ï–ù
–ù–∞ –±–æ–µ–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ –∫–æ–¥ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è. –ö–µ—à –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –æ–¥–∏–Ω —Ä–∞–∑ –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Ö–µ–º—É. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç —Ä–∞–±–æ—Ç—É —Ä–µ—Ñ–ª–µ–∫—Å–∏–∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ —Ç–∞–∫–æ–π –∂–µ –±—ã—Å—Ç—Ä–æ–π, –∫–∞–∫ –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ä–µ–∂–∏–º.
```php
use ZenithGram\ZenithGram\Utils\SimpleFileCache;

// –ü—Ä–∏–º–µ—Ä –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è Production
if (ENV === 'production') {
    // –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —Ñ–∞–π–ª–æ–≤—ã–π –∫–µ—à (—Ö—Ä–∞–Ω–∏—Ç —Å—Ö–µ–º—É –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –≤ —Ñ–∞–π–ª–∞—Ö)
    $cache = new SimpleFileCache(__DIR__ . '/storage/cache');
    
    // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–µ—à–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á–∞–µ—Ç reflection()
    $bot->setCache($cache);
} else {
    // –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ—Å—Ç–æ –≤–∫–ª—é—á–∞–µ–º —Ä–µ—Ñ–ª–µ–∫—Å–∏—é –±–µ–∑ –∫–µ—à–∞
    $bot->reflection();
}
```

## Middleware –∏ –†–µ—Ñ–ª–µ–∫—Å–∏—è
DI —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –≤ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö Middleware, –∏ –≤ Middleware –º–∞—Ä—à—Ä—É—Ç–æ–≤.
–í–∞–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å: –∞—Ä–≥—É–º–µ–Ω—Ç `$next` (–∑–∞–º—ã–∫–∞–Ω–∏–µ –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è —Ü–µ–ø–æ—á–∫–∏) —Ç–∞–∫–∂–µ –Ω—É–∂–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å, –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ.
```php
$bot->middleware(function (UserDto $user, callable $next, ZG $tg) {
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∏–ª–∏ UserDto
    if ($user->id === 12345) {
        $next();
    } else {
        $tg->reply('–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω');
    }
});
```